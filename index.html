<html>
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<style>
		body {
			padding: 0;
			margin: 0;
			background: #c4d2f5;
			background: linear-gradient(to right, #25c481, #25b7c4);
			font-family: 'Roboto', sans-serif;
			color: #fff;
		}
		h1 {
			text-align: center;
		}
		.disable {
			color: #25c194 !important;
			cursor: default;
		}
		#search-bar {
			display: flex;
			justify-content: flex-end;
		}
		main {
			width: 90%;
			max-width: 1000px;
			margin: auto;
			padding: 20px;
		}

		#data {
			width: 100%;
			border: 1px solid #67d6aa;
		}
		#data #list-header {
			font-size: 14px;
			display: flex;
		    line-height: 1.618;
		    color: #fff;
		    background-color: rgba(255,255,255,0.3);
		    padding: 10px 10px;
		}

		#data #list {
			padding: 0;
			margin: 0;
		}
		#data #list li{
			display: flex;
			font-size: 14px;
		    font-weight: 400;
		    line-height: 1.618;
		    padding: 10px 10px;
		    border-bottom: 1px solid #67d6aa52;
		    /*color: #5e5e5e;*/
		}
		#data .search-not-found {
			text-align: center;
			font-size: 20px;
			font-weight: bolder;
			padding: 20px !important;
		}
		#data .name {
			width: 20%;
		}
		#data .id {
			width: 7%;
		}
		#data .nametype {
			width: 11%;
		}
		#data .recclass {
			width: 12%;
		}
		#data .mass {
			width: 10%;
		}
		#data .fall {
			width: 10%;
		}
		#data .year {
			width: 10%;
		}
		#data .latitude {
			width: 10%;
		}
		#data .longitude {
			width: 10%;
		}
		.pagination {
			margin-top: 20px;
			display: flex;
			width:100%; 
			justify-content: center;
		}
		.pagination a {
		  color: #fff;
		  padding: 8px 8px;
		  text-decoration: none;
		  transition: background-color .3s;
		  border: 1px solid #ddd;
		  font-size: 16px;
		}

		.pagination a.active {
		  background-color: rgba(255,255,255,0.3);
		}

		.pagination a:hover:not(.active):not(.disable) {
		  background-color: #ddd;
		}
	</style>
</head>
<body>
	<main>
		<h1>Memeteorite Explorer</h1>
		<div id="search-bar">
			<input type="text" id="search-box" placeholder="Enter search term">
			<button id="search-btn">Search</button>
		</div>
		<div id="data">
			<div id="list-header">
				<span class="name">Name</span>
				<span class="id">Id</span>
				<span class="nametype">Name Type</span>
				<span class="recclass">Rec class</span>
				<span class="mass">Mass(g)</span>
				<span class="fall">Fall</span>
				<span class="year">Year</span>
				<span class="latitude">Latitude</span>
				<span class="longitude">Longitude</span>
			</div>
			<ul id="list">
			</ul>
		</div>
		<div class="pagination">
			<a href="#" class="disable">First</a>
			<a href="#" class="active">1</a>
			<a href="#">2</a>
			<a href="#">3</a>
			<a href="#">4</a>
			<a href="#">5</a>
			<a href="#">6</a>
			<a href="#">7</a>
			<a href="#">8</a>
			<a href="#">9</a>
			<a href="#">10</a>
			<a href="#">Last</a>
			<a href="#" class="disable">&laquo;</a>
			<a href="#">&raquo;</a>
		</div>
	</main>
	<script>
		const createItems = (id, child) => {
			let father = typeof id == 'string'?  document.getElementById(id): id;
			if(!father) {
				let ans = document.getElementById('data');
				father = document.createElement('ul');
				father.id = 'list';
				ans.append(father);
			}
			let c = document.createElement(child)
			father.append(c);
			return c;
		}

		const deleteItems = (id) => {
			let f =  document.getElementById('data');
			let child = document.getElementById(id);
			f.removeChild(child);
		}

		const multiDimensional = (arr, size) => {
			var res = []; 
			for(var i=0;i < arr.length;i = i+size)
				res.push(arr.slice(i,i+size));
			return res;
		}

		const filtering = (items, item) => {
			if (item === 'latitude' || item === 'longitude') {
				if(!items.geolocation) return 'unknown';
				items[item] = items.geolocation.longitude
				items[item] = items.geolocation.latitude;
				return items[item]
			}
			if(!items[item]) {
				return 'unknown';
			}
			if(item === 'year') {
				return items[item].replace(/-.+/, '');
			}
			return items[item];
		}


		const each = (items) => {
			let li = createItems('list', 'li');
			let keys = [
				'name', 'id', 'nametype','recclass', 'mass',
				'fall', 'year', 'latitude', 'longitude'
				];

			for(let i in keys){
				let span = createItems(li, 'span');
				span.className = keys[i];
				span.innerText = filtering(items, keys[i]);
			}
		}

		const loadData = (data) => {
			let newData = multiDimensional(data, 10);
			data = newData[0]
			data.forEach(obj=> each(obj));

			document.getElementById('search-btn').onclick = function () {
				let search = document.getElementById('search-box').value.toLowerCase();
				deleteItems('list');

				if(!search.trim()){
					data.forEach(obj=> each(obj));
				}else {
					let searchedData = data.filter(a => a.name.toLowerCase().includes(search));

					if(!searchedData.length) {
						let ans = document.getElementById('data');
						let div = document.createElement('div');
						div.id = 'list';
						div.className = 'search-not-found';
						ans.append(div);
						div.innerText = 'Search Not Found!';
					}else {
						searchedData.forEach(obj => each(obj));
					}
				} 
			}
		}


		fetch('https://data.nasa.gov/resource/gh4g-9sfh.json')
			.then(e => e.json())
			.then(data => loadData(data));
	 </script>
</body>
</html>